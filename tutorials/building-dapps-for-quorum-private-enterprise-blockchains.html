<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <!-- Favicon -->
    <link rel="icon" href="/img/favicons/favicon.ico">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Truffle Suite">
    <link rel="icon" sizes="192x192" href="/img/favicons/chrome-touch-icon-192x192.png">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Truffle Suite">
    <link rel="apple-touch-icon" href="/img/favicons/apple-touch-icon.png">

    <!-- Tile icon for Win8/10 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="img/favicons/ms-touch-icon-144x144-precomposed.png">
    <meta name="msapplication-TileColor" content="#3372DF">

    <!-- Facebook OpenGraph -->
    <meta property="og:site_name" content="Truffle Suite" />
    <meta property="og:description" content="The Truffle suite of tools make dapp development easier and more consistent." />
    <meta property="og:title" content="Truffle Suite | Tutorials | Building dapps for Quorum: Private Enterprise Blockchains" />
    <meta property="og:url" content="https://trufflesuite.com/tutorials/building-dapps-for-quorum-private-enterprise-blockchai" />
    <meta property="og:type" content="article" />
    <meta property="og:image" content="https://truffleframework.com/img/favicons/truffle-share.png" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="Truffle Suite" />
    <meta name="twitter:title" content="Truffle Suite | Tutorials | Building dapps for Quorum: Private Enterprise Blockchains" />
    <meta name="twitter:description" content="The Truffle suite of tools make dapp development easier and more consistent." />
    <meta name="twitter:creator" content="Truffle Suite" />
    <meta name="twitter:domain" content="trufflesuite.com" />
    <meta name="twitter:image:src" content="https://truffleframework.com/img/favicons/truffle-share.png" />
    
    <meta name="google-site-verification" content="BSgPkMHzw7IxJTpEElNfD8ZZYPzXgOQiTVPzAxAG8-o" />
      
    <title>Truffle Suite | Tutorials | Building dapps for Quorum: Private Enterprise Blockchains</title>

    <link href="https://fonts.googleapis.com/css?family=Grand+Hotel|Open+Sans|Oswald|Varela+Round|Roboto+Condensed|Roboto+Mono" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.9/css/all.css" integrity="sha384-5SOiIsAziJl6AWe0HWRKTXlfcSHKmYV4RBF18PPJ173Kzn7jzMyFuTtk8JA7QQG1" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/index.css">
  </head>
  <body>
    <nav class="navbar navbar-expand-md navbar-dark fixed-top" id="primaryNav">
      <a class="navbar-brand current" href="/">
        <img class="suite-logo" src="/img/truffle-logomark.svg" alt="Truffle Logo" />TRUFFLE SUITE
      </a>
    
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    
      <div class="collapse navbar-collapse" id="navbarsExampleDefault">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" id="suiteDropdown" href="#" data-toggle="dropdown">SUITE</a>
    
            <div class="dropdown-menu">
              <a class="text-truffle" href="/truffle">
                <img class="suite-logo" src="/img/truffle-logomark.svg" alt="Truffle Logo" /><span class="narrow">T</span>RUFFLE
              </a>
              <a class="text-ganache" href="/ganache">
                <img class="suite-logo" src="/img/ganache-logomark.svg" alt="Ganache Logo" />Ganache
              </a>
              <a class="text-drizzle" href="/drizzle">
                <img class="suite-logo" src="/img/drizzle-logomark.svg" alt="Drizzle Logo" />dri<span class="drizzle-z-skew-1">z</span><span class="drizzle-z-skew-2">z</span>le
              </a>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/docs">DOCS</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/tutorials">TUTORIALS</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/boxes">BOXES</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/blog">BLOG</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/community">COMMUNITY</a>
          </li>
        </ul>
      </div>
    </nav>
    <main class="container container-heading container-narrow">
      <div class="row">
        <div class="col">
          <h1>Building dapps for Quorum: Private Enterprise Blockchains</h1>
          <ul class="list-sm-stacker space-icon mb-0">
            <li><i class="far fa-calendar-alt"></i> 2017-05-15&nbsp;&nbsp;&nbsp;</li>
            <li><i class="far fa-user"></i> Tim Coulter</li>
          </ul>
        </div>
      </div>
    </main>

    <main class="banner banner-light-cream pt-5 pb-5" role="main">
      <div class="container container-post">
        <div class="row justify-content-center">
          <div class="col">
            <p>Ethereum is perhaps best defined by its public network, a network where every transaction -- and all participants of each transaction -- are publicly available to anyone looking at its transaction history.</p>
<p>Truffle got its start building for the public blockchain: at the time of Ethereum&#39;s launch, the public blockchain was the only smart contract blockchain around. However since launch, technology has changed, most notably with <a href="https://github.com/jpmorganchase/quorum/wiki">Quorum</a>, the permissioned blockchain initially developed by JP Morgan Chase.</p>
<p>Quorum is a version of Ethereum that adds new features on top of what Ethereum already provides. Specifically, <strong>Quorum adds the ability to create private blockchains between select participants, and more importantly adds transaction privacy on top of normal Ethereum transactions</strong>.</p>
<p>Transaction privacy presents a number of useful use cases, especially in the enterprise and banking worlds. For instance, large banks might want to take advantage of blockchain technologies like Ethereum but don&#39;t want their transactions to be publicly available to everyone as a matter of doing business. Quorum presents a useful alternative.</p>
<p>Let&#39;s use a quick example: Say Bob, Tom, and Alice all create a blockchain together, and Alice wants to send 20 TruffleCoin to Bob. But here&#39;s the kicker: she doesn&#39;t want Tom (or anyone else other than Bob) to know, because she cares about her privacy. Using Quorum, Alice could easily send a transaction where the transaction data is only available to her and Bob.</p>
<p>This tutorial represents Truffle&#39;s official support for Quorum. By the end of this tutorial you&#39;ll learn how to use both Truffle and Quorum together to build privacy-enabled dapps.</p>

    <h2 class="link-markdown">
      <a href="#requirements" name="requirements"><i class="fas fa-link"></i></a>
      Requirements
    </h2>
  <p>This tutorial expects you to have some knowledge of Truffle, Ethereum, Quorum, and Solidity. For more information on these topics, please see the following links:</p>
<ul>
<li><a href="/docs/">Truffle documentation</a></li>
<li><a href="/tutorials/ethereum-overview">Ethereum overview</a></li>
<li><a href="https://www.jpmorgan.com/country/US/EN/Quorum">Quorum overview</a> and <a href="https://github.com/jpmorganchase/quorum/wiki">documentation</a></li>
<li><a href="https://solidity.readthedocs.io/en/develop/">Solidity documentation</a></li>
</ul>
<p>You will primarily be using the command line for this tutorial. Please ensure you have basic familiarity with opening and using the command line provided by your operating system. Additionally, you will need the following software installed before proceeding:</p>
<ul>
<li><a href="https://www.virtualbox.org/wiki/Downloads">VirtualBox</a></li>
<li><a href="https://www.vagrantup.com/downloads.html">Vagrant</a></li>
<li><a href="https://git-scm.com/downloads">Git</a></li>
</ul>

    <h2 class="link-markdown">
      <a href="#getting-started" name="getting-started"><i class="fas fa-link"></i></a>
      Getting Started
    </h2>
  <p>In this tutorial, we&#39;ll show you how to develop dapps for Quorum using Truffle and Quorum&#39;s <a href="https://github.com/jpmorganchase/quorum-examples/tree/master/examples/7nodes">7nodes example</a>. The steps are as follows:</p>
<ul>
<li>Setting up your Quorum client</li>
<li>Connecting Truffle to Quorum</li>
<li>Deploying smart contracts on Quorum</li>
<li>Using Quorum&#39;s privacy features to make transactions private</li>
<li>Interacting with contracts privately</li>
</ul>
<p>You&#39;ll see that developing for Quorum using Truffle is <em>exactly like</em> developing for the public Ethereum blockchain. Truffle supports Quorum out of the box, and the same strategies and methods for building Ethereum-enabled applications for the Ethereum public blockchain also apply to building dapps on Quorum.</p>

    <h2 class="link-markdown">
      <a href="#setting-up-your-quorum-client" name="setting-up-your-quorum-client"><i class="fas fa-link"></i></a>
      Setting up your Quorum client
    </h2>
  <p>The Quorum client is a replacement for the Ethereum client. Using the Quorum client, you can set up a private blockchain that&#39;s only available to you and the people you allow to participate.</p>
<p>We&#39;re going to use a Quorum cluster of seven nodes (so seven Quorum clients) already set up and configured for us inside a virtual machine. You <em>could</em> choose to install Quorum yourself by <a href="https://github.com/jpmorganchase/quorum">downloading it directly</a> and building it from source, but for this example, using the pre-configured cluster is much easier.</p>
<ol>
<li><p>To set up the cluster, open a terminal and navigate to a directory where you&#39;d like it installed. Here, we chose <code>workspace</code>:</p>
<pre><code class="lang-shell">mkdir workspace
cd workspace
</code></pre>
</li>
<li><p>Download the Quorum examples repository:</p>
<pre><code class="lang-shell">git clone https://github.com/jpmorganchase/quorum-examples
</code></pre>
</li>
<li><p>We&#39;ll use Vagrant to initialize the cluster&#39;s virtual machine. Note that this step could take a few minutes as it makes the virtual machine ready for use.</p>
<pre><code class="lang-shell">cd quorum-examples
vagrant up
</code></pre>
</li>
<li><p>After <code>vagrant up</code> successfully completes, we&#39;ll want a way to access our newly minted virtual machine. Note that a virtual machine is like another computer running inside of your own, and so we&#39;ll need a way to access it in order to run commands within the machine. Luckily <code>vagrant</code> provides just such a feature. Type the following command:</p>
<pre><code class="lang-shell">vagrant ssh
</code></pre>
<p>Note that after running this command, our command line changes to show a different prompt:</p>
<pre><code class="lang-shell">ubuntu@ubuntu-xenial:~$
</code></pre>
<p>This designates that we&#39;re running commands inside the virtual machine.</p>
</li>
<li><p>While we&#39;re at the above virtual machine prompt, navigate to the example we want to run:</p>
<pre><code class="lang-shell">ubuntu@ubuntu-xenial:~$ cd quorum-examples/7nodes/
</code></pre>
</li>
<li><p>Our Quorum client is nearly ready to go. We need to run two more commands within the virtual machine. The first one creates seven Quorum nodes we can use to simulate a real Quorum deployment. The second one starts up those seven nodes. While the first command only needs to be run one, you should run the second command anytime you restart the virtual machine.</p>
<pre><code class="lang-shell">ubuntu@ubuntu-xenial:~/quorum-examples/7nodes$ ./raft-init.sh
ubuntu@ubuntu-xenial:~/quorum-examples/7nodes$ ./raft-start.sh
</code></pre>
</li>
</ol>
<p>Success! We now have seven Quorum nodes set up that we can use to represent seven different actors on our private network.</p>

    <h2 class="link-markdown">
      <a href="#connecting-truffle-to-quorum" name="connecting-truffle-to-quorum"><i class="fas fa-link"></i></a>
      Connecting Truffle to Quorum
    </h2>
  <p>To set up Truffle, we&#39;re going to start by creating a bare Truffle project, without any contracts or code.</p>
<ol>
<li><p>We want to leave the old command line window alone and let the Quorum example run without bothering it, so open a second terminal. </p>
</li>
<li><p>In the new terminal, navigate to your workspace and create a new directory for your Truffle project.</p>
<pre><code class="lang-shell">cd workspace
mkdir myproject
</code></pre>
</li>
<li><p>Next, navigate to the new directory and initialize the bare Truffle project:</p>
<pre><code class="lang-shell">cd myproject
truffle init
</code></pre>
<p>If you look at the contents of the <code>myproject</code> directory, you&#39;ll notice directories were created for you. See the <a href="/docs/getting_started/project">Truffle documentation</a> for more information about Truffle&#39;s project structure.</p>
</li>
<li><p>Before moving onto code, we need to configure Truffle to point to our running Quorum client. For this example, we&#39;ll edit our <code>development</code> network configuration within <code>truffle.js</code> to point to the first node available in the 7nodes example:</p>
<pre><code class="lang-javascript">// File: `truffle.js` (edited for 7nodes example)
module.exports = {
  networks: {
    development: {
      host: &quot;127.0.0.1&quot;,
      port: 22000, // was 8545
      network_id: &quot;*&quot;, // Match any network id
      gasPrice: 0,
      gas: 4500000
    }
  }
};
</code></pre>
<p>Note that we changed the port that Truffle normally connects to (we changed it to <code>22000</code>). Because of the magic of VirtualBox and Vagrant, the node running inside the virtual machine is made available to us via local ports, so connecting via <code>127.0.0.1</code> and <code>22000</code> will work just fine.</p>
<p class="alert alert-info">
<strong>Note</strong>: The seven Quorum clients respond on ports <code>22000</code> (node 1) through <code>22006</code> (node 7).
</p>

</li>
</ol>
<p>Now that we have Truffle set up, we can move onto code.</p>

    <h2 class="link-markdown">
      <a href="#deploying-smart-contracts-on-quorum" name="deploying-smart-contracts-on-quorum"><i class="fas fa-link"></i></a>
      Deploying smart contracts on Quorum
    </h2>
  <p>We won&#39;t spend too much time talking about writing or deploying contracts in Truffle since we have <a href="/docs">ample documentation</a>, however we do want to show how deploying contracts applies to Quorum.</p>
<ol>
<li><p>First, copy the following contract into a new file, called <code>SimpleStorage.sol</code>. Place it in your <code>contracts/</code> directory:</p>
<pre><code class="lang-javascript">// File: `./contracts/SimpleStorage.sol`

pragma solidity ^0.4.17;

contract SimpleStorage {
  uint public storedData;

  constructor(uint initVal) public {
    storedData = initVal;
  }

  function set(uint x) public {
    storedData = x;
  }

  function get() view public returns (uint retVal) {
    return storedData;
  }
}
</code></pre>
</li>
<li><p>Ensure the contract compiles using the command <code>truffle compile</code> within your project directory.</p>
<pre><code class="lang-shell">truffle compile
</code></pre>
</li>
<li><p>Next, create a new migration called <code>2_deploy_simplestorage.js</code> within your <code>migrations/</code> directory. Note that this migration is just like any other you&#39;d create for Truffle, but there&#39;s one important difference. Let&#39;s see if you can catch it.</p>
<pre><code class="lang-javascript">// File: `./migrations/2_deploy_simplestorage.js`

var SimpleStorage = artifacts.require(&quot;SimpleStorage&quot;);

module.exports = function(deployer) {
  // Pass 42 to the contract as the first constructor parameter
  deployer.deploy(SimpleStorage, 42, {privateFor: [&quot;ROAZBWtSacxXQrOe3FGAqJDyJjFePR5ce4TSIzmJ0Bc=&quot;]})
};
</code></pre>
<p>If you guessed the difference was <code>privateFor</code>, you got it! <code>privateFor</code> is an extra transaction parameter added to Quorum that specifies that <strong>the transaction you&#39;re making</strong> -- in this case a contract deployment -- <strong>is private for a specific account, identified by the given public key</strong>. For this transaction, the public key we chose represents node 7. Since we previously configured Truffle to connect to node 1, this transaction will deploy a contract from node 1, making the transaction private between node 1 and node 7.</p>
</li>
<li><p>Now it&#39;s time to deploy your contracts. Run the <code>truffle migrate</code> command and watch your contracts be successfully deployed:</p>
<pre><code class="lang-shell">truffle migrate
</code></pre>
<p>You will see output that looks like this. Your transaction IDs will be different though.</p>
<pre><code class="lang-shell">Using network &#39;development&#39;.

Running migration: 1_initial_migration.js
  Deploying Migrations...
  Migrations: 0x721650d027d87cd247a3a776c4b6170bf1e5b936
Saving successful migration to network...
Saving artifacts...
Running migration: 2_deploy_simplestorage.js
  Deploying SimpleStorage...
  SimpleStorage: 0x10ae69385c79ef3eb815ac008a7013d6878f1d38
Saving successful migration to network...
Saving artifacts...
</code></pre>
</li>
</ol>
<p>Now that the contract&#39;s deployed, it&#39;s off to the races.</p>

    <h2 class="link-markdown">
      <a href="#using-quorum-39-s-privacy-features-to-make-transactions-private" name="using-quorum-39-s-privacy-features-to-make-transactions-private"><i class="fas fa-link"></i></a>
      Using Quorum&#39;s privacy features to make transactions private
    </h2>
  <p>We originally configured Truffle to point our development environment to the first of the seven nodes provided by the example. You can think of the first node as &quot;us&quot;, as if we were developing a dapp for a private network that&#39;s used by multiple other parties. Since the 7nodes example provides us seven nodes to work with, we can tell Truffle about the other nodes so we can &quot;be&quot; someone else, and ensure the contract we deployed was private.</p>
<ol>
<li><p>To add a new network configuration, edit your <code>truffle.js</code> file again and add additional network configuration, choosing a network name that best describes the network connection you&#39;re adding. In this case, we&#39;re going to add a connection to node 4 (<code>nodefour</code>) and node 7 (<code>nodeseven</code>):</p>
<pre><code class="lang-javascript">// File: `truffle.js`
module.exports = {
  networks: {
    development: {
      host: &quot;127.0.0.1&quot;,
      port: 22000, // was 8545
      network_id: &quot;*&quot;, // Match any network id
      gasPrice: 0,
      gas: 4500000
    },
    nodefour:  {
      host: &quot;127.0.0.1&quot;,
      port: 22003,
      network_id: &quot;*&quot;, // Match any network id
      gasPrice: 0,
      gas: 4500000
    },
    nodeseven:  {
      host: &quot;127.0.0.1&quot;,
      port: 22006,
      network_id: &quot;*&quot;, // Match any network id
      gasPrice: 0,
      gas: 4500000
    }
  }
};
</code></pre>
<p>Like before, VirtualBox and Vagrant are making these nodes available to us through local ports, so these configurations can look the same as our <code>development</code> configuration except with a different ports specified.</p>
</li>
<li><p>Now that our configuration is set up, we can use the Truffle console to interact with our deployed contract. First let&#39;s be &quot;us&quot; (node 1), configured via our <code>development</code> configuration. The easiest way to do this is to launch the <a href="/docs/getting_started/console">Truffle console</a>, which lets us interact with our deployed contracts directly.</p>
<pre><code class="lang-shell">truffle console
</code></pre>
<p>You will see a new prompt:</p>
<pre><code class="lang-shell">truffle(development)&gt;
</code></pre>
</li>
<li><p>Here, we&#39;ll get the deployed instance of the SimpleStorage contract and then get the integer value we specified on deployment. Enter the following command:</p>
<pre><code class="lang-shell">truffle(development)&gt; SimpleStorage.deployed().then(function(instance) { return instance.get(); })
</code></pre>
<p>You&#39;ll see the following response:</p>
<pre><code class="lang-shell">{ [String: &#39;42&#39;] s: 1, e: 1, c: [ 42 ] }
</code></pre>
<p>Note that Truffle&#39;s contract abstractions use Promises to interact with Ethereum. This can be a little cumbersome on the console as it requires a few extra key strokes to get things done, but within your application it makes control flow a lot smoother. Additionally, take a look at the output we received: We got <code>42</code> back, but as an object. This is because Ethereum can represent larger numbers than those natively represented by JavaScript, and so we need an abstraction in order to interact with them.</p>
</li>
<li><p>Now let&#39;s try accessing the SimpleStorage contract as node four. To do this, quit out of the console (using <code>Ctrl + C</code> / <code>Command + C</code>), and then launch the console again, but this time specifying the connection to node 4 instead of node 1:</p>
<pre><code class="lang-shell">truffle console --network nodefour
</code></pre>
<p>You&#39;ll see a new prompt:</p>
<pre><code class="lang-shell">truffle(nodefour)&gt;
</code></pre>
</li>
<li><p>Run the same command as above to get the integer value from the SimpleStorage contract: </p>
<pre><code class="lang-shell">truffle(nodefour)&gt; SimpleStorage.deployed().then(function(instance) { return instance.get(); })
</code></pre>
<p>You&#39;ll see the following response:</p>
<pre><code class="lang-shell">{ [String: &#39;0&#39;] s: 1, e: 0, c: [ 0 ] }
</code></pre>
<p>You&#39;ll notice we got <code>0</code> back instead. This is because the accounts represented by node 4 weren&#39;t privy to this contract.</p>
</li>
<li><p>Lastly we can try with node 7, which <em>was</em> privy to this contract. Quit and relaunch the console again:</p>
<pre><code class="lang-shell">truffle console --network nodeseven
</code></pre>
<p>You&#39;ll see a new prompt:</p>
<pre><code class="lang-shell">truffle(nodeseven)&gt;
</code></pre>
</li>
<li><p>Run the same command as above to get the integer value from the SimpleStorage contract: </p>
<pre><code class="lang-shell">truffle(nodeseven)&gt; SimpleStorage.deployed().then(function(instance) { return instance.get(); })
</code></pre>
<p>You&#39;ll see the following response:</p>
<pre><code class="lang-shell">{ [String: &#39;42&#39;] s: 1, e: 1, c: [ 42 ] }
</code></pre>
<p>As you can see, we get <code>42</code>! This shows that we can deploy contracts that are only available to our desired parties.</p>
</li>
</ol>

    <h2 class="link-markdown">
      <a href="#interacting-with-contracts-privately" name="interacting-with-contracts-privately"><i class="fas fa-link"></i></a>
      Interacting with contracts privately
    </h2>
  <p>So far, we&#39;ve shown you how to deploy contracts that are private within your migrations. When building a dapp on Quorum, it&#39;d also be helpful to learn how to make <em>all</em> transactions private.</p>
<p>Truffle uses its <a href="https://github.com/trufflesuite/truffle/tree/master/packages/truffle-contract">truffle-contract</a> contract abstraction wherever contracts are used in JavaScript. When you interacted with <code>SimpleStorage</code> in the console above, for instance, you were using a <code>truffle-contract</code> contract abstraction. These abstractions are also used within your migrations, your JavaScript-based unit tests, as well as executing external scripts with Truffle.</p>
<p>Truffle&#39;s contract abstraction allow you to make a transaction against any function available on the contract. It does so by evaluating the functions of the contract and making them available to JavaScript. To see these transactions in action, we&#39;re going to use an advanced feature of Truffle that lets us execute external scripts within our Truffle environment.</p>
<ol>
<li><p>Creating a file called <code>sampletx.js</code> and save it in the root of your project (the same directory as your <code>truffle.js</code> file). Then fill it with this code:</p>
<pre><code class="lang-javascript">var SimpleStorage = artifacts.require(&quot;SimpleStorage&quot;);

module.exports = function(done) {
  console.log(&quot;Getting deployed version of SimpleStorage...&quot;)
  SimpleStorage.deployed().then(function(instance) {
    console.log(&quot;Setting value to 65...&quot;);
    return instance.set(65, {privateFor: [&quot;ROAZBWtSacxXQrOe3FGAqJDyJjFePR5ce4TSIzmJ0Bc=&quot;]});
  }).then(function(result) {
    console.log(&quot;Transaction:&quot;, result.tx);
    console.log(&quot;Finished!&quot;);
    done();
  }).catch(function(e) {
    console.log(e);
    done();
  });
};
</code></pre>
<p>This code does two things: First, it asks Truffle to get our contract abstraction for the SimpleStorage contract. Then, it finds the deployed contract and sets the value managed by SimpleStorage to <code>65</code>, using the contract&#39;s <code>set()</code> function. As with the migration we wrote previously, the <code>privateFor</code> parameter can be appended within an object at the end of the transaction to tell Quorum that this transaction is private between the sender and the account represented by the given public key.</p>
</li>
<li><p>Run this code using <code>truffle exec</code>:</p>
<pre><code class="lang-shell">truffle exec sampletx.js
</code></pre>
<p>Your output should look something like this (your transaction ID will be different though):</p>
<pre><code class="lang-shell">Using network &#39;development&#39;.

Getting deployed version of SimpleStorage...
Setting value to 65...
Transaction: 0x0a7a661e657f5a706b0c39b4f197038ef0c3e77abc9970a623327c6f48ca9aff
Finished!
</code></pre>
</li>
<li><p>We can now use the Truffle console, like before, to check the results of this transaction. Let&#39;s see the value as node one:</p>
<pre><code class="lang-shell">truffle console
</code></pre>
<pre><code class="lang-shell">truffle(development)&gt; SimpleStorage.deployed().then(function(instance) { return instance.get(); })
</code></pre>
<p>The response will be:</p>
<pre><code class="lang-shell">{ [String: &#39;65&#39;] s: 1, e: 1, c: [ 65 ] }
</code></pre>
<p>We got <code>65</code>! Now let&#39;s do node 4 (not privy to the transaction):</p>
<pre><code class="lang-shell">truffle console --network nodefour
</code></pre>
<pre><code class="lang-shell">truffle(nodefour)&gt; SimpleStorage.deployed().then(function(instance) { return instance.get(); })
</code></pre>
<p>The response will be:</p>
<pre><code class="lang-shell">{ [String: &#39;0&#39;] s: 1, e: 0, c: [ 0 ] }
</code></pre>
<p>We got zero, as expected. Now let&#39;s try node 7:</p>
<pre><code class="lang-shell">truffle console --network nodeseven
</code></pre>
<pre><code class="lang-shell">truffle(nodeseven)&gt; SimpleStorage.deployed().then(function(instance) { return instance.get(); })
</code></pre>
<p>The response will be:</p>
<pre><code class="lang-shell">{ [String: &#39;65&#39;] s: 1, e: 1, c: [ 65 ] }
</code></pre>
</li>
</ol>
<p>And we got <code>65</code> again, as we should expect. This is how we can use Truffle&#39;s contract abstractions to make private transactions with Quorum.</p>

    <h2 class="link-markdown">
      <a href="#is-that-all-truffle-can-do-" name="is-that-all-truffle-can-do-"><i class="fas fa-link"></i></a>
      Is that all Truffle can do?
    </h2>
  <p>Absolutely not! What we&#39;ve shown you today is everything that makes building dapps for Quorum different than building dapps for the public Ethereum network. And what you&#39;ll see is it&#39;s not different at all: The only difference is adding the <code>privateFor</code> parameter for deployments and transactions you&#39;d like to keep private. The rest is the same!</p>
<p>In fact, now that you have the basics, you can explore <a href="/docs">all our other resources</a> for building dapps with Truffle, including <a href="/tutorials">tutorials</a>, <a href="/docs/getting_started/migrations">writing advanced deployment scripts</a>, <a href="/docs/getting_started/javascript-tests">unit testing</a> (<a href="/docs/getting_started/solidity-tests">with Solidity too</a>), and much more.</p>
<p>By building with Truffle, you now have access to not only the best development tools and technologies (like Quorum), but you also have access to the largest Ethereum developer community around. Don&#39;t hesitate to <a href="https://twitter.com/trufflesuite">drop us a line on Twitter</a> or <a href="https://gitter.im/ConsenSys/truffle">get help from fellow Trufflers in our community Gitter channel</a>. There&#39;s always someone available to answer any questions you have.</p>
<p>Cheers, and happy coding!</p>


            <div class="contribute-link">
              See a way to make this page better? <a href="https://github.com/trufflesuite/trufflesuite.com/edit/master/src/tutorials">Edit here &raquo;</a>
            </div>          </div>
        </div>
      </div>
    </main>

    <footer>
      <div class="container">
        <div class="row">
          <div class="col-12 col-md-2 mb-4 mb-md-0">
            <img class="truffle-logo" src="/img/truffle-logo-light.svg" alt="Truffle Logo" />
          </div>
    
          <div class="col-12 col-md-5 mb-3 mb-md-0">
            <ul>
              <!--<li><a href="/careers">CAREERS</a></li>-->
              <li><a href="mailto:inquiry@trufflesuite.com">CONTACT US</a></li>
              <li><a href="/policy">PRIVACY POLICY</a></li>
              <li><a href="/dashboard">DASHBOARD</a></li>
              <li><a href="https://github.com/trufflesuite">GITHUB</a></li>
              <li><a href="https://twitter.com/trufflesuite">TWITTER</a></li>
              <li><a class="trufflecon-link" href="/trufflecon2018">TRUFFLEC<img src="/img/truffle-logomark.svg" alt="Truffle Logo" /><span>O</span>N 2018</a></li>
              <li class="text-truffle">
                <a href="https://new.consensys.net/">
                  <img class="consensys-logomark" src="/img/consensys-logomark.svg" alt="ConsenSys Logo" />
                  &copy; CONSENSYS 2018
                </a>
              </li>
            </ul>
          </div>
    
          <div class="col-12 col-md-5">
            <h4>SIGN UP FOR THE TRUFFLE MAILING LIST</h4>
            <form>
              <div class="form-group">
                <input type="email" class="form-control" id="footerMailingEmail" placeholder="Email Address">
              </div>
              <div class="form-group">
                <input type="text" class="form-control" id="footerMailingFirstName" placeholder="First Name">
                <small id="firstNameHelp" class="form-text text-muted">So we know how to address you.</small>
              </div>
              <button type="submit" class="btn btn-truffle">SUBSCRIBE</button>
            </form>
          </div>
        </div>
      </div>
    </footer>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script>window.jQuery || document.write('<script src="/js/vendor/jquery-3.2.1.slim.min.js"><\/script>')</script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/vendor/prism.js"></script>
    <script src="/js/markdown-cleanup.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-83874933-3', 'auto');
      ga('send', 'pageview');
    </script>  </body>
</html>